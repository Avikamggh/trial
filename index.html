<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Xploreon Learning Platform</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Orbitron', sans-serif;
            background: linear-gradient(135deg, #0a0a1a 0%, #1a0a2a 50%, #0a1a3a 100%);
            min-height: 100vh;
            color: white;
            position: relative;
            overflow-x: hidden;
        }

        .glass-effect {
            background: rgba(0, 255, 255, 0.07);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(0, 255, 255, 0.2);
        }

        .glow-text {
            color: #00ffe0;
            text-shadow: 0 0 15px #00ffe0, 0 0 30px #00ffe0;
        }

        .glow-tm {
            text-shadow: 0 0 6px #00ffe0, 0 0 10px #00ffe0;
            font-weight: bold;
            margin-left: 2px;
            animation: pulseTM 1.5s infinite alternate;
        }

        @keyframes pulseTM {
            from { opacity: 0.7; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }

        /* Animated Starfield */
        .starfield {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }

        .star {
            position: absolute;
            width: 2px;
            height: 2px;
            background: #00ffe0;
            border-radius: 50%;
            animation: twinkle 4s infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.5); }
        }

        /* Navigation */
        .navbar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            padding: 1rem;
        }

        /* Mobile Menu */
        #mobileMenu {
            transform: translateY(-100%);
            opacity: 0;
            transition: all 0.4s ease;
            visibility: hidden;
            max-height: 0;
            overflow: hidden;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(10px);
            z-index: 99;
            padding-top: 80px;
        }

        #mobileMenu.show {
            transform: translateY(0);
            opacity: 1;
            visibility: visible;
            max-height: 500px;
        }

        /* Progress Container - Fixed for mobile */
        .progress-container {
            position: fixed;
            top: 80px;
            left: 1rem;
            right: 1rem;
            background: rgba(0, 20, 40, 0.95);
            backdrop-filter: blur(15px);
            border: 2px solid rgba(0, 255, 255, 0.3);
            border-radius: 15px;
            padding: 1rem;
            z-index: 90;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        .progress-ring {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: conic-gradient(from 0deg, #00ffe0 0%, #0099cc 25%, #667eea 50%, #764ba2 75%, #333 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            flex-shrink: 0;
        }

        .progress-ring::before {
            content: '';
            position: absolute;
            width: 45px;
            height: 45px;
            background: rgba(0, 20, 40, 0.95);
            border-radius: 50%;
        }

        .progress-percentage {
            position: relative;
            z-index: 1;
            font-size: 12px;
            font-weight: bold;
            color: #00ffe0;
        }

        /* Main Content */
        .main-content {
            margin-top: 220px;
            padding: 1rem;
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Premium Button */
        .premium-floating-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 45;
            background: linear-gradient(45deg, #ffd700, #ffed4a, #ffd700);
            background-size: 200% 200%;
            animation: shimmer 2s infinite;
            color: #000;
            font-weight: bold;
            padding: 12px 20px;
            border-radius: 50px;
            border: none;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.4);
            transition: all 0.3s ease;
            font-size: 14px;
        }

        @keyframes shimmer {
            0% { background-position: 0% 0%; }
            100% { background-position: 200% 200%; }
        }

        /* Step Cards */
        .step-card {
            background: rgba(0, 20, 40, 0.8);
            backdrop-filter: blur(15px);
            border: 2px solid rgba(0, 255, 255, 0.3);
            border-radius: 20px;
            transition: all 0.4s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            margin-bottom: 1.5rem;
            padding: 1.5rem;
        }

        .step-card:hover {
            transform: translateY(-5px);
            border-color: #00ffe0;
            box-shadow: 0 15px 30px rgba(0, 255, 255, 0.3);
        }

        .step-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #00ffe0, #0099cc);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin: 0 auto 1rem;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.5);
            animation: float 6s ease-in-out infinite;
            flex-shrink: 0;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-8px); }
        }

        .step-completed .step-icon {
            background: linear-gradient(135deg, #00ff88, #00cc66);
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.7);
        }

        .step-locked .step-icon {
            background: linear-gradient(135deg, #666666, #444444);
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Video Controls */
        .custom-video-container {
            position: relative;
            background: #000;
            border-radius: 15px;
            overflow: hidden;
            width: 100%;
            aspect-ratio: 16/9;
        }

        .youtube-container {
            position: relative;
            background: #000;
            border-radius: 15px;
            overflow: hidden;
            width: 100%;
            aspect-ratio: 16/9;
        }

        .youtube-player {
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 15px;
        }

        .custom-video-controls {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(transparent, rgba(0, 0, 0, 0.8));
            padding: 1rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .custom-video-container:hover .custom-video-controls {
            opacity: 1;
        }

        .play-pause-btn, .fullscreen-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
        }

        .play-pause-btn:hover, .fullscreen-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .video-progress-bar {
            flex: 1;
            height: 4px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 2px;
            overflow: hidden;
            position: relative;
            cursor: not-allowed;
        }

        .video-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #00ffe0, #0099cc);
            border-radius: 2px;
            transition: width 0.1s ease;
        }

        .video-time-display {
            color: white;
            font-size: 12px;
            min-width: 80px;
            text-align: right;
        }

        /* YouTube Overlay */
        .youtube-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(transparent, rgba(0, 0, 0, 0.8));
            display: flex;
            align-items: flex-end;
            justify-content: center;
            z-index: 10;
            pointer-events: none;
            border-radius: 15px;
        }

        .youtube-progress-info {
            padding: 1rem;
            background: rgba(0, 0, 0, 0.8);
            border-radius: 10px;
            margin: 1rem;
            text-align: center;
        }

        /* Certificate Styles */
        .certificate-container {
            position: relative;
            background: linear-gradient(135deg, #1a1a2e, #16213e, #0f3460);
            border: 3px solid #ffd700;
            border-radius: 20px;
            padding: 2rem;
            margin: 1rem 0;
            min-height: 400px;
        }

        .certificate {
            position: relative;
            z-index: 1;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 15px;
            padding: 2rem;
            color: white;
            filter: blur(8px);
            transition: all 0.5s ease;
        }

        .certificate-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2;
            color: white;
            transition: all 0.5s ease;
        }

        .certificate-container.unlocked .certificate-overlay {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }

        .certificate-container.unlocked .certificate {
            filter: none;
            transform: scale(1);
        }

        .progress-text {
            background: rgba(0, 255, 255, 0.2);
            border: 1px solid rgba(0, 255, 255, 0.4);
            padding: 0.5rem 1rem;
            border-radius: 10px;
            font-size: 14px;
            font-weight: bold;
            color: #00ffe0;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 1000;
            backdrop-filter: blur(10px);
            overflow-y: auto;
        }

        .modal-content {
            position: relative;
            margin: 2rem auto;
            background: linear-gradient(135deg, rgba(0, 20, 40, 0.95), rgba(10, 0, 30, 0.95));
            border: 2px solid rgba(0, 255, 255, 0.3);
            border-radius: 20px;
            padding: 1.5rem;
            max-width: 900px;
            width: 90%;
            backdrop-filter: blur(15px);
        }

        /* Learning Stats */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }

        .stat-card {
            background: rgba(0, 20, 40, 0.8);
            backdrop-filter: blur(15px);
            border: 2px solid rgba(0, 255, 255, 0.3);
            border-radius: 15px;
            padding: 1rem;
            text-align: center;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            border-color: #00ffe0;
            transform: translateY(-3px);
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #00ffe0;
            display: block;
        }

        .stat-label {
            font-size: 0.8rem;
            opacity: 0.8;
            margin-top: 0.5rem;
        }

        /* Achievement Animation */
        .achievement-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            background: linear-gradient(135deg, #ffd700, #ffed4a);
            color: #000;
            padding: 2rem;
            border-radius: 20px;
            font-weight: bold;
            font-size: 18px;
            z-index: 1001;
            border: 3px solid #ff6b35;
            box-shadow: 0 0 50px rgba(255, 215, 0, 0.8);
            opacity: 0;
            transition: all 0.5s ease;
            text-align: center;
            max-width: 90%;
        }

        .achievement-popup.show {
            transform: translate(-50%, -50%) scale(1);
            opacity: 1;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .progress-container {
                top: 70px;
                left: 0.5rem;
                right: 0.5rem;
                padding: 0.75rem;
                z-index: 90;
            }

            .main-content {
                margin-top: 180px;
                padding: 1rem;
            }

            .step-card {
                padding: 1rem;
            }

            .step-icon {
                width: 50px;
                height: 50px;
                font-size: 20px;
            }

            .modal-content {
                margin: 1rem;
                width: calc(100% - 2rem);
                padding: 1rem;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.5rem;
            }

            .stat-card {
                padding: 0.75rem;
            }

            .stat-value {
                font-size: 1.2rem;
            }

            .progress-ring {
                width: 50px;
                height: 50px;
            }

            .progress-ring::before {
                width: 35px;
                height: 35px;
            }

            .progress-percentage {
                font-size: 10px;
            }

            .premium-floating-btn {
                bottom: 15px;
                right: 15px;
                padding: 10px 16px;
                font-size: 12px;
            }

            h1 {
                font-size: 2rem !important;
            }

            .play-pause-btn, .fullscreen-btn {
                width: 35px;
                height: 35px;
                font-size: 14px;
            }
        }

        @media (max-width: 480px) {
            .progress-container {
                top: 65px;
                left: 0.25rem;
                right: 0.25rem;
                padding: 0.5rem;
            }

            .main-content {
                margin-top: 160px;
                padding: 0.5rem;
            }

            .step-card {
                padding: 0.75rem;
            }

            .modal-content {
                margin: 0.5rem;
                width: calc(100% - 1rem);
                padding: 0.75rem;
            }

            .stats-grid {
                grid-template-columns: 1fr 1fr;
                gap: 0.25rem;
            }

            .stat-card {
                padding: 0.5rem;
            }

            .stat-value {
                font-size: 1rem;
            }

            .progress-ring {
                width: 40px;
                height: 40px;
            }

            .progress-ring::before {
                width: 28px;
                height: 28px;
            }

            .progress-percentage {
                font-size: 8px;
            }

            h1 {
                font-size: 1.5rem !important;
            }

            .play-pause-btn, .fullscreen-btn {
                width: 30px;
                height: 30px;
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <!-- Starfield Background -->
    <div class="starfield" id="starfield"></div>

    <!-- Navigation -->
    <nav class="navbar glass-effect">
        <div class="flex justify-between items-center">
            <a href="index.html" class="text-xl md:text-2xl glow-text">
                Xploreon<sup class="text-cyan-400 text-xs md:text-sm glow-tm">‚Ñ¢</sup>
            </a>

            <button id="menuToggle" class="md:hidden text-white text-2xl">‚ò∞</button>

            <ul class="desktop-nav hidden md:flex space-x-4 lg:space-x-6 text-white text-sm">
                <li><a href="mission.html" class="hover:text-cyan-400 transition-colors">Mission</a></li>
                <li><a href="tech.html" class="hover:text-cyan-400 transition-colors">Tech</a></li>
                <li><a href="team.html" class="hover:text-cyan-400 transition-colors">Team</a></li>
                <li><a href="news.html" class="hover:text-cyan-400 transition-colors">News</a></li>
                <li><a href="tracker.html" class="hover:text-cyan-400 transition-colors">Tracker</a></li>
                <li><a href="competition.html" class="hover:text-cyan-400 transition-colors">Competition</a></li>
                 <li><a href="ladder-game.html" class="hover:text-cyan-400 transition-colors">Learning</a></li>
                <li><a href="contact.html" class="hover:text-cyan-400 transition-colors">Contact</a></li>
               
            </ul>
        </div>
    </nav>

    <!-- Mobile Menu -->
    <ul id="mobileMenu" class="md:hidden flex-col bg-black bg-opacity-95 text-white p-4 fixed w-full top-16 left-0 backdrop-blur-lg border-b border-cyan-400">
        <li><a href="mission.html" class="block py-3 px-2 hover:text-cyan-400 transition-colors" onclick="toggleMobileMenu()">üéØ Mission</a></li>
        <li><a href="tech.html" class="block py-3 px-2 hover:text-cyan-400 transition-colors" onclick="toggleMobileMenu()">üî¨ Tech</a></li>
        <li><a href="team.html" class="block py-3 px-2 hover:text-cyan-400 transition-colors" onclick="toggleMobileMenu()">üë• Team</a></li>
        <li><a href="news.html" class="block py-3 px-2 hover:text-cyan-400 transition-colors" onclick="toggleMobileMenu()">üì∞ News</a></li>
        <li><a href="tracker.html" class="block py-3 px-2 hover:text-cyan-400 transition-colors" onclick="toggleMobileMenu()">üõ∞Ô∏è Tracker</a></li>
        <li><a href="competition.html" class="block py-3 px-2 hover:text-cyan-400 transition-colors" onclick="toggleMobileMenu()">üèÜ Competition</a></li>
        <li><a href="ladder-game.html" class="block py-3 px-2 hover:text-cyan-400 transition-colors" onclick="toggleMobileMenu()">üéì Learning</a></li>
        <li><a href="contact.html" class="block py-3 px-2 hover:text-cyan-400 transition-colors" onclick="toggleMobileMenu()">üìû Contact</a></li>
        
    </ul>

    <!-- Premium Floating Button -->
    <button class="premium-floating-btn" onclick="openPremiumModal()">
        üíé Premium
    </button>

    <!-- Progress Container -->
    <div class="progress-container">
        <div class="flex items-center justify-between">
            <div class="progress-ring">
                <div class="progress-percentage" id="progressPercentage">0%</div>
            </div>
            <div class="flex-1 ml-4">
                <h3 class="text-sm md:text-lg font-bold glow-text">Learning Progress</h3>
                <p class="text-xs md:text-sm opacity-80" id="progressText">0/14 Videos Complete</p>
                <div class="mt-2">
                    <div class="w-full bg-gray-700 rounded-full h-2">
                        <div class="bg-gradient-to-r from-cyan-400 to-blue-500 h-2 rounded-full transition-all duration-500" id="progressBar" style="width: 0%"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="main-content">
        <div class="text-center mb-8">
            <h1 class="text-3xl md:text-5xl lg:text-6xl font-bold glow-text mb-4">
                üöÄ Space Explorer 
            </h1>
            <p class="text-lg md:text-xl opacity-80">Master the cosmos through interactive video lessons</p>
        </div>

        <!-- Learning Stats -->
        <div class="stats-grid mb-8">
            <div class="stat-card">
                <span class="stat-value" id="totalTime">0h 0m</span>
                <div class="stat-label">Watch Time</div>
            </div>
            <div class="stat-card">
                <span class="stat-value" id="completedVideos">0</span>
                <div class="stat-label">Completed</div>
            </div>
            <div class="stat-card">
                <span class="stat-value" id="streakCount">0</span>
                <div class="stat-label">Day Streak</div>
            </div>
            <div class="stat-card" onclick="openCertificateModal()" style="cursor: pointer;">
                <span class="stat-value" id="certificateStatus">üîí</span>
                <div class="stat-label">Certificate</div>
            </div>
        </div>

        <!-- Learning Path -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 lg:gap-6" id="learningPath">
            <!-- Videos will be populated here -->
        </div>
    </main>

    <!-- Video Modal -->
    <div class="modal" id="videoModal">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl md:text-2xl font-bold glow-text" id="videoTitle">Video Title</h2>
                <button onclick="closeVideoModal()" class="text-white hover:text-red-500 text-2xl md:text-3xl">&times;</button>
            </div>
            
            <!-- YouTube Video Container -->
            <div class="youtube-container" id="youtubeContainer" style="display: none;">
                <div id="youtubePlayer"></div>
            </div>

            <!-- Regular Video Container -->
            <div class="custom-video-container" id="videoContainer" style="display: none;">
                <video id="videoPlayer" class="w-full h-full" preload="metadata">
                    <source src="" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
                
                <div class="custom-video-controls" id="customControls">
                    <button class="play-pause-btn" id="playPauseBtn">
                        <span id="playPauseIcon">‚ñ∂</span>
                    </button>
                    <div class="video-progress-bar" id="progressBarVideo">
                        <div class="video-progress-fill" id="progressFill" style="width: 0%"></div>
                    </div>
                    <div class="video-time-display" id="timeDisplay">0:00 / 0:00</div>
                    <button class="fullscreen-btn" id="fullscreenBtn">
                        <span id="fullscreenIcon">‚õ∂</span>
                    </button>
                </div>
            </div>
            
            <div class="mt-4">
                <h3 class="text-lg font-semibold mb-4">Learning Objectives:</h3>
                <ul class="space-y-2" id="learningObjectives">
                    <!-- Objectives will be populated here -->
                </ul>
                
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center pt-6 gap-4">
                    <span class="text-sm opacity-60">Duration: <span id="videoDuration">6 minutes</span></span>
                    <div class="bg-blue-500 bg-opacity-20 text-blue-300 py-2 px-4 rounded-lg text-sm w-full md:w-auto text-center" id="videoStatus">
                        üé• Watch to completion for auto-progress
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Certificate Modal -->
    <div class="modal" id="certificateModal">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl md:text-2xl font-bold glow-text">üèÜ Space Explorer Certificate</h2>
                <button onclick="closeCertificateModal()" class="text-white hover:text-red-500 text-2xl md:text-3xl">&times;</button>
            </div>
            
            <div class="certificate-container" id="certificateContainer">
                <div class="certificate" id="certificate">
                    <div class="text-center mb-6">
                        <h1 class="text-2xl md:text-4xl font-bold text-yellow-400 mb-2">CERTIFICATE OF COMPLETION</h1>
                        <div class="text-sm text-blue-300">Space Explorer</div>
                    </div>
                    
                    <div class="text-center px-4 md:px-8">
                        <div class="text-lg mb-4">This is to certify that</div>
                        <div class="text-2xl md:text-3xl font-bold text-cyan-400 mb-6" id="studentName">Space Explorer</div>
                        <div class="text-base mb-4">has successfully completed the comprehensive</div>
                        <div class="text-xl md:text-2xl font-semibold text-yellow-400 mb-6">Space Exploration Masterclass</div>
                        <div class="text-sm mb-6">
                            Demonstrating mastery in rocket science, orbital mechanics, space missions,<br>
                            and advanced space exploration technologies
                        </div>
                        
                        <div class="flex justify-between items-end mt-8 text-sm">
                            <div>
                                <div class="border-t border-gray-400 pt-2">
                                    <div class="font-semibold">Avikam Deol</div>
                                    <div class="text-xs">Founder & CEO</div>
                                </div>
                            </div>
                            <div class="text-center">
                                <div class="text-4xl text-yellow-400 mb-2">üöÄ</div>
                                <div class="text-xs">Xploreon‚Ñ¢</div>
                            </div>
                            <div>
                                <div class="border-t border-gray-400 pt-2">
                                    <div class="font-semibold" id="completionDate">January 2025</div>
                                    <div class="text-xs">Date of Completion</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="certificate-overlay" id="certificateOverlay">
                    <div class="text-center">
                        <div class="text-4xl mb-4">üîí</div>
                        <h3 class="text-xl font-bold mb-2">Certificate Locked</h3>
                        <p class="text-sm opacity-80 mb-4">Complete all 14 videos to unlock your certificate</p>
                        <div class="progress-text" id="certificateProgress">0/14 Videos Completed</div>
                    </div>
                </div>
            </div>
            
            <div class="mt-6 text-center">
                <button id="downloadCertificate" class="bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed" disabled onclick="downloadCertificate()">
                    üìú Download Certificate
                </button>
                <div class="mt-3 text-xs opacity-70">
                    High-quality certificate with verification code
                </div>
            </div>
        </div>
    </div>

<!-- Premium Modal -->
<div class="modal" id="premiumModal">
    <div class="modal-content" style="background: linear-gradient(135deg, #0a0a1a 0%, #1a0a2a 50%, #0a1a3a 100%);">
        <div class="text-center">
            <button onclick="closePremiumModal()" class="absolute top-4 right-4 text-white hover:text-gray-300 text-2xl">&times;</button>
            
            <div class="text-4xl md:text-6xl mb-4">üíé</div>
            <h2 class="text-2xl md:text-3xl font-bold mb-2 text-white">Unlock Premium Learning</h2>
            <p class="text-white opacity-80 mb-6 md:mb-8">Access exclusive video content and advanced features</p>

            <!-- Inner box color: light gray for balance -->
            <div class="bg-gray-800 p-5 rounded-xl shadow-lg mb-6">
                <h3 class="text-xl font-semibold text-white mb-3">What's Included in Premium:</h3>
                <ul class="text-gray-300 text-sm space-y-3">
                    <li>üåü <strong>4 Weekly Live Sessions</strong>: Participate in live sessions to get real-time feedback and guidance from experts.</li>
                    <li>üë®‚Äçüè´ <strong>Mentorship</strong>: Receive personalized mentorship from our experienced team to guide you through your learning journey.</li>
                    <li>üéÅ <strong>Exclusive Benefits</strong>: Access other premium resources and updates available only to members.</li>
                </ul>
            </div>

            <button onclick="redirectToPayment()" class="w-full bg-gradient-to-r from-teal-400 to-teal-600 text-white font-bold py-3 md:py-4 px-6 rounded-lg hover:from-teal-500 hover:to-teal-700 transition-all transform hover:scale-105">
                üöÄ Launch Premium Journey - $18/month
            </button>
            
            <p class="text-xs text-white opacity-70 mt-4">
                30-day money-back guarantee ‚Ä¢ Secure payment by Stripe
            </p>
        </div>
    </div>
</div>

    <!-- Achievement Popup -->
    <div class="achievement-popup" id="achievementPopup">
        <div class="flex items-center space-x-3">
            <div class="text-2xl md:text-3xl">üéâ</div>
            <div>
                <div class="font-bold">Video Complete!</div>
                <div class="text-sm opacity-80">Next level unlocked!</div>
            </div>
        </div>
    </div>

    <!-- YouTube API -->
    <script src="https://www.youtube.com/iframe_api"></script>

    <script>
        // Learning Videos Data from your curriculum
        const learningVideos = [
            {
                id: 1,
                title: "Introduction to Space Exploration",
                description: "Overview of space exploration history and future",
                icon: "üöÄ",
                duration: "6 min",
                difficulty: "Beginner",
                videoUrl: "https://youtu.be/EiTpNvksK3k",
                isYouTube: true, 
                objectives: [
                    "Overview of space exploration history",
                    "Major milestones in human space exploration",
                    "The role of space exploration in advancing technology and science",
                    "Future of space exploration (Mars missions, commercial spaceflight)"
                ]
            },
            {
                id: 2,
                title: "Basic Principles of Rocket Science",
                description: "Introduction to rocketry and propulsion fundamentals",
                icon: "üöÄ",
                duration: "11 min",
                difficulty: "Beginner",
                videoUrl: "1.mp4",
                objectives: [
                    "Introduction to rocketry and propulsion",
                    "Newton's Laws of Motion",
                    "Basic concepts of thrust, gravity, and drag",
                    "Types of rockets and their components"
                ]
            },
            {
                id: 3,
                title: "Orbital Mechanics and Satellites",
                description: "Understanding orbits and satellite operations",
                icon: "üõ∞Ô∏è",
                duration: "12 min",
                difficulty: "Intermediate",
                videoUrl: "1.mp4",
                objectives: [
                    "Understanding orbits: circular, elliptical, geostationary",
                    "Kepler's Laws of Planetary Motion",
                    "How satellites stay in orbit",
                    "Types of satellites and their functions"
                ]
            },
            {
                id: 4,
                title: "Space Travel and Astronauts' Journey",
                description: "The journey from Earth to space",
                icon: "üë®‚ÄçüöÄ",
                duration: "8 min",
                difficulty: "Beginner",
                videoUrl: "1.mp4",
                objectives: [
                    "The journey of astronauts from Earth to space",
                    "Technology and systems required for space travel",
                    "Life in space: challenges and adaptations (zero gravity, radiation)",
                    "The role of the International Space Station (ISS)"
                ]
            },
            {
                id: 5,
                title: "Rocket Launch and Staging Systems",
                description: "How rocket launches work and staging systems",
                icon: "üöÄ",
                duration: "10 min",
                difficulty: "Intermediate",
                videoUrl: "1.mp4",
                objectives: [
                    "How rocket launches work",
                    "Launch stages: boosters, main stage, and payload separation",
                    "The importance of multi-stage rockets in reaching space",
                    "Examples of famous rocket launches (Apollo missions, Falcon 9)"
                ]
            },
            {
                id: 6,
                title: "Spacecraft Design and Engineering",
                description: "Basics of spacecraft design and engineering",
                icon: "üõ∏",
                duration: "11 min",
                difficulty: "Intermediate",
                videoUrl: "1.mp4",
                objectives: [
                    "Basics of spacecraft design: structure, thermal protection, propulsion",
                    "How spacecraft are built for different missions (lunar landing, Mars exploration)",
                    "The role of materials and innovations in spacecraft engineering"
                ]
            },
            {
                id: 7,
                title: "Space Missions: Apollo, Mars, and Beyond",
                description: "Detailed history of significant space missions",
                icon: "üåô",
                duration: "17 min",
                difficulty: "Intermediate",
                videoUrl: "1.mp4",
                objectives: [
                    "Detailed history of significant space missions (Apollo 11, Mars Rover)",
                    "What we learned from past missions",
                    "Future missions: Artemis, Mars human landing, deep space exploration"
                ]
            },
            {
                id: 8,
                title: "Space Technologies and Innovations",
                description: "Key technologies that make space exploration possible",
                icon: "‚öôÔ∏è",
                duration: "9 min",
                difficulty: "Intermediate",
                videoUrl: "1.mp4",
                objectives: [
                    "Key technologies: ion engines, GPS, communication satellites",
                    "Innovations in materials (heat shields, carbon fiber)",
                    "The role of AI in space exploration"
                ]
            },
            {
                id: 9,
                title: "Space Habitation: Colonizing Mars",
                description: "The concept of sustainable habitats in space",
                icon: "üî¥",
                duration: "13 min",
                difficulty: "Advanced",
                videoUrl: "1.mp4",
                objectives: [
                    "The concept of sustainable habitats in space",
                    "Challenges of living on Mars (oxygen, food, water)",
                    "Technologies required to create a self-sustaining colony on Mars",
                    "The role of SpaceX and other private companies in Mars colonization"
                ]
            },
            {
                id: 10,
                title: "The Future of Space Travel",
                description: "Hypersonic, space tourism, and interstellar exploration",
                icon: "üåå",
                duration: "9 min",
                difficulty: "Advanced",
                videoUrl: "1.mp4",
                objectives: [
                    "Emerging technologies for faster space travel (hyperloop, spacecraft)",
                    "The future of space tourism: SpaceX, Blue Origin",
                    "Long-term goals: interstellar travel, propulsion systems like nuclear fusion"
                ]
            },
            {
                id: 11,
                title: "The Role of AI and Robotics in Space Exploration",
                description: "AI and robotics in modern space missions",
                icon: "ü§ñ",
                duration: "9 min",
                difficulty: "Advanced",
                videoUrl: "1.mp4",
                objectives: [
                    "AI in space exploration: rovers, autonomous spacecraft, AI mission control",
                    "Robotics in space: robotic arms, robotic probes, and autonomous systems",
                    "Real-world examples: Mars rovers, European Space Agency's robotics"
                ]
            },
            {
                id: 12,
                title: "Space Law and International Cooperation",
                description: "Introduction to space law and treaties",
                icon: "‚öñÔ∏è",
                duration: "8 min",
                difficulty: "Advanced",
                videoUrl: "1.mp4",
                objectives: [
                    "Introduction to space law and treaties (Outer Space Treaty, Moon Agreement)",
                    "How international space cooperation works: ISS, joint missions",
                    "Future challenges in space governance (asteroid mining, space debris)"
                ]
            },
            {
                id: 13,
                title: "Space Exploration and Earth: Benefits to Humanity",
                description: "Space technologies that benefit life on Earth",
                icon: "üåç",
                duration: "7 min",
                difficulty: "Intermediate",
                videoUrl: "1.mp4",
                objectives: [
                    "Space technologies that benefit life on Earth (satellite communication, weather forecasting)",
                    "Environmental monitoring and disaster management using space tech",
                    "How space exploration inspires innovation in various fields (materials science, medicine)"
                ]
            },
            {
                id: 14,
                title: "Introduction to Space Robotics",
                description: "From rovers to space stations",
                icon: "ü§ñ",
                duration: "9 min",
                difficulty: "Advanced",
                videoUrl: "1.mp4",
                objectives: [
                    "The importance of robotics in space exploration",
                    "How rovers work: mobility, communication, sensors",
                    "Robotic arms and other space-based robots: uses in assembly and maintenance (ISS)"
                ]
            }
        ];

        // YouTube Player Variables
        let youtubePlayer = null;
        let youtubePlayerReady = false;
        let currentVideoId = null;
        let watchedTime = 0;
        let totalDuration = 0;
        let lastTimeUpdate = 0;
        let isVideoCompleted = false;
        let checkInterval = null;

        // YouTube API Ready Callback
        function onYouTubeIframeAPIReady() {
            // YouTube API is ready
        }

        // Extract YouTube Video ID from URL
        function getYouTubeVideoId(url) {
            const regex = /(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/;
            const match = url.match(regex);
            return match ? match[1] : null;
        }

        // Learning Progress Manager
        class LearningProgressManager {
            constructor() {
                this.state = {
                    completedVideos: JSON.parse(localStorage.getItem('xploreon_completed_videos') || '[]'),
                    videoProgress: JSON.parse(localStorage.getItem('xploreon_video_progress') || '{}'),
                    totalWatchTime: parseInt(localStorage.getItem('xploreon_watch_time') || '0'),
                    streakCount: parseInt(localStorage.getItem('xploreon_streak') || '0'),
                    lastActiveDate: localStorage.getItem('xploreon_last_date') || null
                };
                this.currentVideoId = null;
                this.updateStreak();
            }

            updateStreak() {
                const today = new Date().toDateString();
                const lastDate = this.state.lastActiveDate;
                
                if (lastDate === today) {
                    return;
                } else if (lastDate) {
                    const last = new Date(lastDate);
                    const current = new Date(today);
                    const diffTime = Math.abs(current - last);
                    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                    
                    if (diffDays === 1) {
                        this.state.streakCount++;
                    } else if (diffDays > 1) {
                        this.state.streakCount = 1;
                    }
                } else {
                    this.state.streakCount = 1;
                }
                
                this.state.lastActiveDate = today;
                this.saveState();
            }

            isVideoUnlocked(videoId) {
                if (videoId === 1) return true;
                return this.state.completedVideos.includes(videoId - 1);
            }

            isVideoCompleted(videoId) {
                return this.state.completedVideos.includes(videoId);
            }

            completeVideo(videoId) {
                if (!this.state.completedVideos.includes(videoId)) {
                    this.state.completedVideos.push(videoId);
                    
                    const video = learningVideos.find(v => v.id === videoId);
                    if (video) {
                        const duration = parseInt(video.duration);
                        this.state.totalWatchTime += duration;
                    }
                    
                    this.state.videoProgress[videoId] = {
                        completedAt: new Date().toISOString(),
                        watchedFully: true
                    };
                    
                    this.saveState();
                    this.showAchievement();
                    this.updateProgress();
                    
                    // Check if all videos are completed
                    if (this.state.completedVideos.length === 14) {
                        this.promptForCertificateName();
                    }
                }
            }

            promptForCertificateName() {
                // Just show completion message without asking for name
                // Name will be asked when user clicks certificate button
                const completionPopup = document.getElementById('achievementPopup');
                if (completionPopup) {
                    completionPopup.innerHTML = `
                        <div class="flex items-center space-x-3">
                            <div class="text-2xl md:text-3xl">üèÜ</div>
                            <div>
                                <div class="font-bold">All Lessons Complete!</div>
                                <div class="text-sm opacity-80">Click certificate to get yours!</div>
                            </div>
                        </div>
                    `;
                    completionPopup.classList.add('show');
                    setTimeout(() => completionPopup.classList.remove('show'), 4000);
                }
            }

            getProgress() {
                const completed = this.state.completedVideos.length;
                const total = learningVideos.length;
                return {
                    percentage: Math.round((completed / total) * 100),
                    completed,
                    total
                };
            }

            formatTime(minutes) {
                const hours = Math.floor(minutes / 60);
                const mins = minutes % 60;
                return `${hours}h ${mins}m`;
            }

            saveState() {
                localStorage.setItem('xploreon_completed_videos', JSON.stringify(this.state.completedVideos));
                localStorage.setItem('xploreon_video_progress', JSON.stringify(this.state.videoProgress));
                localStorage.setItem('xploreon_watch_time', this.state.totalWatchTime.toString());
                localStorage.setItem('xploreon_streak', this.state.streakCount.toString());
                localStorage.setItem('xploreon_last_date', this.state.lastActiveDate);
            }

            updateProgress() {
                const progress = this.getProgress();
                
                // Update progress displays with error checking
                const elements = {
                    progressPercentage: document.getElementById('progressPercentage'),
                    progressText: document.getElementById('progressText'),
                    progressBar: document.getElementById('progressBar'),
                    totalTime: document.getElementById('totalTime'),
                    completedVideos: document.getElementById('completedVideos'),
                    streakCount: document.getElementById('streakCount'),
                    certificateStatus: document.getElementById('certificateStatus')
                };
                
                if (elements.progressPercentage) elements.progressPercentage.textContent = `${progress.percentage}%`;
                if (elements.progressText) elements.progressText.textContent = `${progress.completed}/14 Videos Complete`;
                if (elements.progressBar) elements.progressBar.style.width = `${progress.percentage}%`;
                if (elements.totalTime) elements.totalTime.textContent = this.formatTime(this.state.totalWatchTime);
                if (elements.completedVideos) elements.completedVideos.textContent = progress.completed;
                if (elements.streakCount) elements.streakCount.textContent = this.state.streakCount;
                
                // Update certificate status
                if (elements.certificateStatus) {
                    if (progress.completed === 14) {
                        elements.certificateStatus.textContent = 'üèÜ';
                        elements.certificateStatus.parentElement.style.background = 'linear-gradient(135deg, #ffd700, #ffed4a)';
                        elements.certificateStatus.parentElement.style.color = '#000';
                    } else {
                        elements.certificateStatus.textContent = `${progress.completed}/14`;
                    }
                }
                
                // Update progress ring
                const ring = document.querySelector('.progress-ring');
                if (ring) {
                    ring.style.background = `conic-gradient(from 0deg, #00ffe0 0%, #0099cc ${progress.percentage * 3.6}deg, #333 ${progress.percentage * 3.6}deg)`;
                }
                
                this.updateCertificatePreview();
            }

            showAchievement() {
                const popup = document.getElementById('achievementPopup');
                if (popup) {
                    popup.classList.add('show');
                    setTimeout(() => popup.classList.remove('show'), 3000);
                }
            }

            updateCertificatePreview() {
                const certificateContainer = document.getElementById('certificateContainer');
                const certificateProgress = document.getElementById('certificateProgress');
                const downloadBtn = document.getElementById('downloadCertificate');
                const progress = this.getProgress();
                
                if (certificateProgress) {
                    certificateProgress.textContent = `${progress.completed}/14 Videos Completed`;
                }
                
                if (progress.completed === 14) {
                    if (certificateContainer) certificateContainer.classList.add('unlocked');
                    if (downloadBtn) {
                        downloadBtn.disabled = false;
                        downloadBtn.textContent = 'üìú Download Certificate';
                    }
                } else {
                    if (certificateContainer) certificateContainer.classList.remove('unlocked');
                    if (downloadBtn) {
                        downloadBtn.disabled = true;
                        downloadBtn.textContent = `üîí Complete ${14 - progress.completed} more videos`;
                    }
                }
            }
        }

        // Initialize Progress Manager
        const progressManager = new LearningProgressManager();

        // Initialize starfield
        function createStarfield() {
            const starfield = document.getElementById('starfield');
            if (!starfield) return;
            
            for (let i = 0; i < 50; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 4 + 's';
                starfield.appendChild(star);
            }
        }

        // Initialize learning path
        function initializeLearningPath() {
            const container = document.getElementById('learningPath');
            if (!container) return;
            
            container.innerHTML = '';

            learningVideos.forEach((video) => {
                const isCompleted = progressManager.isVideoCompleted(video.id);
                const isUnlocked = progressManager.isVideoUnlocked(video.id);
                const isLocked = !isUnlocked;

                const videoCard = document.createElement('div');
                videoCard.className = `step-card text-center relative ${
                    isCompleted ? 'step-completed' : isLocked ? 'step-locked' : ''
                }`;

                // Create the status display at the bottom based on the actual video state
                let statusHtml = '';
                if (isCompleted) {
                    statusHtml = '<div class="bg-green-500 bg-opacity-20 text-green-300 py-2 px-4 rounded-lg text-sm">‚úÖ Completed</div>';
                } else if (isLocked) {
                    statusHtml = '<div class="bg-gray-500 bg-opacity-20 text-gray-400 py-2 px-4 rounded-lg text-sm">üîí Complete previous video</div>';
                } else {
                    statusHtml = `<button class="bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded-lg transition-colors w-full text-sm" onclick="openVideo(${video.id})">üé• Watch Video</button>`;
                }

                videoCard.innerHTML = `
                    <div class="step-icon ${isCompleted ? 'step-completed' : isLocked ? 'step-locked' : ''}">
                        ${isCompleted ? '‚úÖ' : isLocked ? 'üîí' : video.icon}
                    </div>
                    
                    <h3 class="text-lg font-bold mb-2">${video.title}</h3>
                    <p class="text-sm opacity-80 mb-4">${video.description}</p>
                    
                    <div class="flex justify-between items-center text-xs mb-4">
                        <span class="flex items-center space-x-1">
                            <span>‚è±Ô∏è</span>
                            <span>${video.duration}</span>
                        </span>
                        <span class="flex items-center space-x-1">
                            <span>üìä</span>
                            <span>${video.difficulty}</span>
                        </span>
                    </div>
                    
                    <div class="mt-4">
                        ${statusHtml}
                    </div>
                `;

                if (!isLocked) {
                    videoCard.style.cursor = 'pointer';
                    videoCard.onclick = () => openVideo(video.id);
                }

                container.appendChild(videoCard);
            });
        }

        // YouTube Player State Change Handler
        function onPlayerStateChange(event) {
            if (event.data === YT.PlayerState.PLAYING) {
                startWatchTimeTracking();
            } else if (event.data === YT.PlayerState.PAUSED || event.data === YT.PlayerState.ENDED) {
                stopWatchTimeTracking();
            }

            if (event.data === YT.PlayerState.ENDED) {
                checkVideoCompletion();
            }
        }

        // YouTube Player Ready Handler
        function onPlayerReady(event) {
            youtubePlayerReady = true;
            totalDuration = youtubePlayer.getDuration();
            updateYouTubeProgressDisplay();
        }

        // Start tracking watch time
        function startWatchTimeTracking() {
            if (checkInterval) clearInterval(checkInterval);
            
            checkInterval = setInterval(() => {
                if (youtubePlayer && youtubePlayerReady) {
                    const currentTime = youtubePlayer.getCurrentTime();
                    
                    // Only count forward progression
                    if (currentTime > lastTimeUpdate && (currentTime - lastTimeUpdate) < 2) {
                        watchedTime += (currentTime - lastTimeUpdate);
                    }
                    
                    lastTimeUpdate = currentTime;
                    updateYouTubeProgressDisplay();
                    checkVideoCompletion();
                }
            }, 1000);
        }

        // Stop tracking watch time
        function stopWatchTimeTracking() {
            if (checkInterval) {
                clearInterval(checkInterval);
                checkInterval = null;
            }
        }

        // Update YouTube progress display
        function updateYouTubeProgressDisplay() {
            // Progress tracking happens silently in the background
            // No visual elements to update since overlay is removed
        }

        // Check video completion
        function checkVideoCompletion() {
            if (!youtubePlayer || !youtubePlayerReady || isVideoCompleted) return;

            const duration = youtubePlayer.getDuration();
            const currentTime = youtubePlayer.getCurrentTime();
            
            // Require 90% watch time and 95% progress
            const requiredWatchTime = duration * 0.9;
            const requiredProgress = duration * 0.95;
            
            if (watchedTime >= requiredWatchTime && currentTime >= requiredProgress) {
                isVideoCompleted = true;
                
                if (!progressManager.isVideoCompleted(currentVideoId)) {
                    progressManager.completeVideo(currentVideoId);
                    initializeLearningPath();
                    
                    // Update status below video
                    const videoStatus = document.getElementById('videoStatus');
                    if (videoStatus) {
                        videoStatus.innerHTML = 'üéâ Video completed! Well done!';
                        videoStatus.className = 'bg-green-500 bg-opacity-20 text-green-300 py-2 px-4 rounded-lg text-sm w-full md:w-auto text-center';
                    }
                }
            }
        }

        // Open video modal
        function openVideo(videoId) {
            const video = learningVideos.find(v => v.id === videoId);
            if (!video) return;

            currentVideoId = videoId;
            watchedTime = 0;
            lastTimeUpdate = 0;
            isVideoCompleted = false;

            const modal = document.getElementById('videoModal');
            const title = document.getElementById('videoTitle');
            const objectives = document.getElementById('learningObjectives');
            const duration = document.getElementById('videoDuration');
            const videoStatus = document.getElementById('videoStatus');
            const youtubeContainer = document.getElementById('youtubeContainer');
            const videoContainer = document.getElementById('videoContainer');

            if (title) title.textContent = `Video ${video.id}: ${video.title}`;
            if (duration) duration.textContent = video.duration;

            // Reset video status
            if (videoStatus) {
                videoStatus.innerHTML = 'üé• Watch to completion for auto-progress';
                videoStatus.className = 'bg-blue-500 bg-opacity-20 text-blue-300 py-2 px-4 rounded-lg text-sm w-full md:w-auto text-center';
            }

            if (objectives) {
                objectives.innerHTML = '';
                video.objectives.forEach(objective => {
                    const li = document.createElement('li');
                    li.className = 'flex items-start space-x-2';
                    li.innerHTML = `
                        <span class="text-cyan-400 mt-1 text-sm">‚úì</span>
                        <span class="text-sm">${objective}</span>
                    `;
                    objectives.appendChild(li);
                });
            }

            // Handle YouTube vs regular video
            if (video.isYouTube) {
                const videoIdYT = getYouTubeVideoId(video.videoUrl);
                if (videoIdYT) {
                    // Show YouTube container, hide regular video container
                    if (youtubeContainer) youtubeContainer.style.display = 'block';
                    if (videoContainer) videoContainer.style.display = 'none';

                    // Destroy existing player if any
                    if (youtubePlayer) {
                        youtubePlayer.destroy();
                    }

                    // Create new YouTube player
                    youtubePlayer = new YT.Player('youtubePlayer', {
                        width: '100%',
                        height: '100%',
                        videoId: videoIdYT,
                        playerVars: {
                            autoplay: 0,
                            controls: 1,
                            rel: 0,
                            showinfo: 0,
                            modestbranding: 1,
                            fs: 1,
                            cc_load_policy: 0,
                            iv_load_policy: 3,
                            disablekb: 1,
                            playsinline: 1,
                            origin: window.location.origin,
                            widget_referrer: window.location.origin,
                            enablejsapi: 1
                        },
                        events: {
                            onReady: onPlayerReady,
                            onStateChange: onPlayerStateChange
                        }
                    });
                }
            } else {
                // Show regular video container, hide YouTube container
                if (youtubeContainer) youtubeContainer.style.display = 'none';
                if (videoContainer) videoContainer.style.display = 'block';

                const videoPlayer = document.getElementById('videoPlayer');
                if (videoPlayer) {
                    videoPlayer.src = video.videoUrl;
                    setupNonSkippableControls(videoPlayer, videoId);
                }
            }

            if (modal) modal.style.display = 'block';
            progressManager.currentVideoId = videoId;
        }

        // Non-skippable video controls for regular videos
        function setupNonSkippableControls(videoElement, videoId) {
            const playPauseBtn = document.getElementById('playPauseBtn');
            const playPauseIcon = document.getElementById('playPauseIcon');
            const fullscreenBtn = document.getElementById('fullscreenBtn');
            const fullscreenIcon = document.getElementById('fullscreenIcon');
            const progressFill = document.getElementById('progressFill');
            const timeDisplay = document.getElementById('timeDisplay');
            const progressBarVideo = document.getElementById('progressBarVideo');
            const videoContainer = document.getElementById('videoContainer');
            
            let actualWatchTime = 0;
            let lastTime = 0;
            let hasCompletedVideo = false;
            
            // Disable default controls
            videoElement.controls = false;
            videoElement.controlsList = 'nodownload nofullscreen noremoteplayback';
            videoElement.disablePictureInPicture = true;
            
            // Play/Pause button
            if (playPauseBtn) {
                playPauseBtn.onclick = () => {
                    if (videoElement.paused) {
                        videoElement.play();
                    } else {
                        videoElement.pause();
                    }
                };
            }

            // Fullscreen button
            if (fullscreenBtn) {
                fullscreenBtn.onclick = () => {
                    if (!document.fullscreenElement) {
                        if (videoContainer.requestFullscreen) {
                            videoContainer.requestFullscreen();
                        } else if (videoContainer.mozRequestFullScreen) {
                            videoContainer.mozRequestFullScreen();
                        } else if (videoContainer.webkitRequestFullscreen) {
                            videoContainer.webkitRequestFullscreen();
                        } else if (videoContainer.msRequestFullscreen) {
                            videoContainer.msRequestFullscreen();
                        }
                    } else {
                        if (document.exitFullscreen) {
                            document.exitFullscreen();
                        } else if (document.mozCancelFullScreen) {
                            document.mozCancelFullScreen();
                        } else if (document.webkitExitFullscreen) {
                            document.webkitExitFullscreen();
                        } else if (document.msExitFullscreen) {
                            document.msExitFullscreen();
                        }
                    }
                };
            }

            // Listen for fullscreen changes
            document.addEventListener('fullscreenchange', updateFullscreenIcon);
            document.addEventListener('mozfullscreenchange', updateFullscreenIcon);
            document.addEventListener('webkitfullscreenchange', updateFullscreenIcon);
            document.addEventListener('msfullscreenchange', updateFullscreenIcon);

            function updateFullscreenIcon() {
                if (fullscreenIcon) {
                    fullscreenIcon.textContent = document.fullscreenElement ? '‚äô' : '‚õ∂';
                }
            }
            
            // Update play/pause icon
            videoElement.addEventListener('play', () => {
                if (playPauseIcon) playPauseIcon.textContent = '‚è∏';
                lastTime = videoElement.currentTime;
            });
            
            videoElement.addEventListener('pause', () => {
                if (playPauseIcon) playPauseIcon.textContent = '‚ñ∂';
            });
            
            // Track actual watch time
            videoElement.addEventListener('timeupdate', () => {
                const currentTime = videoElement.currentTime;
                const duration = videoElement.duration;
                
                if (currentTime > lastTime && currentTime - lastTime < 2) {
                    actualWatchTime += (currentTime - lastTime);
                }
                lastTime = currentTime;
                
                // Update progress bar
                if (duration > 0) {
                    const progressPercent = (currentTime / duration) * 100;
                    if (progressFill) progressFill.style.width = progressPercent + '%';
                    
                    // Update time display
                    const currentMin = Math.floor(currentTime / 60);
                    const currentSec = Math.floor(currentTime % 60);
                    const totalMin = Math.floor(duration / 60);
                    const totalSec = Math.floor(duration % 60);
                    
                    if (timeDisplay) {
                        timeDisplay.textContent = `${currentMin}:${currentSec.toString().padStart(2, '0')} / ${totalMin}:${totalSec.toString().padStart(2, '0')}`;
                    }
                }
                
                // Check completion (90% watch requirement)
                const requiredWatchTime = duration * 0.9;
                if (actualWatchTime >= requiredWatchTime && currentTime >= duration * 0.95 && !hasCompletedVideo) {
                    hasCompletedVideo = true;
                    if (!progressManager.isVideoCompleted(videoId)) {
                        progressManager.completeVideo(videoId);
                        initializeLearningPath();
                        
                        const statusElement = document.getElementById('videoStatus');
                        if (statusElement) {
                            statusElement.innerHTML = 'üéâ Video completed! Well done!';
                            statusElement.className = 'bg-green-500 bg-opacity-20 text-green-300 py-2 px-4 rounded-lg text-sm w-full md:w-auto text-center';
                        }
                    }
                }
            });
            
            // Prevent seeking
            videoElement.addEventListener('seeked', () => {
                const currentTime = videoElement.currentTime;
                
                if (currentTime > lastTime + 5) {
                    videoElement.currentTime = lastTime;
                    
                    const warning = document.createElement('div');
                    warning.style.cssText = `
                        position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
                        background: rgba(255, 0, 0, 0.9); color: white; padding: 1rem 2rem;
                        border-radius: 10px; z-index: 1000; font-weight: bold;
                    `;
                    warning.textContent = '‚ö†Ô∏è Skipping not allowed! Please watch the full video.';
                    document.body.appendChild(warning);
                    
                    setTimeout(() => {
                        if (warning.parentNode) {
                            warning.parentNode.removeChild(warning);
                        }
                    }, 3000);
                }
            });
            
            // Disable progress bar clicking
            if (progressBarVideo) {
                progressBarVideo.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                });
            }
        }

        // Close video modal
        function closeVideoModal() {
            const modal = document.getElementById('videoModal');
            const videoPlayer = document.getElementById('videoPlayer');
            
            // Stop YouTube tracking
            stopWatchTimeTracking();
            
            // Destroy YouTube player
            if (youtubePlayer) {
                youtubePlayer.destroy();
                youtubePlayer = null;
                youtubePlayerReady = false;
            }

            // Reset regular video player
            if (videoPlayer) {
                videoPlayer.pause();
                videoPlayer.currentTime = 0;
                videoPlayer.src = '';
            }

            // Exit fullscreen if active
            if (document.fullscreenElement) {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                } else if (document.mozCancelFullScreen) {
                    document.mozCancelFullScreen();
                } else if (document.webkitExitFullscreen) {
                    document.webkitExitFullscreen();
                } else if (document.msExitFullscreen) {
                    document.msExitFullscreen();
                }
            }
            
            if (modal) modal.style.display = 'none';
            
            // Reset tracking variables
            currentVideoId = null;
            watchedTime = 0;
            lastTimeUpdate = 0;
            isVideoCompleted = false;
        }

        // Certificate functions
        function openCertificateModal() {
            const modal = document.getElementById('certificateModal');
            const progress = progressManager.getProgress();
            
            // If all videos are completed, ask for name
            if (progress.completed === 14) {
                const userName = prompt('üéâ Congratulations! All lessons completed!\n\nEnter your name for the certificate:') || 'Space Explorer';
                localStorage.setItem('xploreon_student_name', userName);
                
                const studentNameEl = document.getElementById('studentName');
                if (studentNameEl) studentNameEl.textContent = userName;
            } else {
                // For incomplete progress, show default
                const studentNameEl = document.getElementById('studentName');
                if (studentNameEl) studentNameEl.textContent = 'Space Explorer';
            }
            
            const completionDateEl = document.getElementById('completionDate');
            if (completionDateEl) {
                completionDateEl.textContent = new Date().toLocaleDateString('en-US', { 
                    year: 'numeric', 
                    month: 'long' 
                });
            }
            
            progressManager.updateCertificatePreview();
            if (modal) modal.style.display = 'block';
        }

        function closeCertificateModal() {
            const modal = document.getElementById('certificateModal');
            if (modal) modal.style.display = 'none';
        }

        function downloadCertificate() {
            const progress = progressManager.getProgress();
            if (progress.completed < 14) {
                alert('Please complete all 14 videos to download your certificate.');
                return;
            }

            // Get the stored name (should already be set when opening the modal)
            let studentName = localStorage.getItem('xploreon_student_name');
            if (!studentName || studentName === 'Space Explorer') {
                studentName = prompt('Enter your name for the certificate:') || 'Space Explorer';
                localStorage.setItem('xploreon_student_name', studentName);
                
                // Update the displayed name in the modal
                const studentNameEl = document.getElementById('studentName');
                if (studentNameEl) studentNameEl.textContent = studentName;
            }

            const completionDate = new Date().toLocaleDateString('en-US', { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
            const certificateId = 'XPL-' + Date.now().toString(36).toUpperCase();
            
            const certificateHTML = `
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Space Explorer Certificate - ${studentName}</title>
                    <style>
                        body { font-family: 'Arial', sans-serif; margin: 0; padding: 20px; background: #1a1a2e; }
                        .certificate { 
                            max-width: 800px; margin: 0 auto; background: linear-gradient(135deg, #1a1a2e, #16213e, #0f3460);
                            border: 5px solid #ffd700; border-radius: 20px; padding: 40px; color: white; text-align: center;
                        }
                        .header { font-size: 28px; color: #ffd700; margin-bottom: 20px; }
                        .student-name { font-size: 32px; color: #00ffe0; margin: 20px 0; }
                        .course-name { font-size: 24px; color: #ffd700; margin: 20px 0; }
                        .footer { display: flex; justify-content: space-between; margin-top: 40px; }
                        .cert-id { position: absolute; bottom: 10px; right: 10px; font-size: 10px; opacity: 0.7; }
                    </style>
                </head>
                <body>
                    <div class="certificate">
                        <div class="header">üöÄ CERTIFICATE OF COMPLETION üöÄ</div>
                        <div>Space Explorer</div>
                        <div style="margin: 30px 0;">This is to certify that</div>
                        <div class="student-name">${studentName}</div>
                        <div>has successfully completed the comprehensive</div>
                        <div class="course-name">Space Exploration Masterclass</div>
                        <div style="margin: 20px 0; font-size: 14px;">
                            Demonstrating mastery in rocket science, orbital mechanics, space missions,<br>
                            and advanced space exploration technologies
                        </div>
                        <div style="margin: 20px 0;">
                            Total Study Time: ${progressManager.formatTime(progressManager.state.totalWatchTime)}<br>
                            Videos Completed: 14/14
                        </div>
                        <div class="footer">
                            <div>Avikam Deol<br><small>Founder & CEO</small></div>
                            <div>${completionDate}<br><small>Date of Completion</small></div>
                        </div>
                        <div class="cert-id">Certificate ID: ${certificateId}</div>
                    </div>
                </body>
                </html>
            `;

            const blob = new Blob([certificateHTML], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Space_Explorer_Certificate_${studentName.replace(/\s+/g, '_')}.html`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            alert(`üéâ Certificate downloaded successfully for ${studentName}!`);
        }

        // Mobile menu toggle
        function toggleMobileMenu() {
            const mobileMenu = document.getElementById('mobileMenu');
            const toggle = document.getElementById('menuToggle');
            
            if (mobileMenu && toggle) {
                mobileMenu.classList.toggle('show');
                toggle.textContent = mobileMenu.classList.contains('show') ? '‚úï' : '‚ò∞';
            }
        }

        // Premium modal functions
        function openPremiumModal() {
            const modal = document.getElementById('premiumModal');
            if (modal) modal.style.display = 'block';
        }

        function closePremiumModal() {
            const modal = document.getElementById('premiumModal');
            if (modal) modal.style.display = 'none';
        }

        function redirectToPayment() {
            window.open('https://buy.stripe.com/4gM8wI1C333x1i3fdVc7u0b', '_blank');
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            createStarfield();
            initializeLearningPath();
            progressManager.updateProgress();
            
            // Menu toggle
            const menuToggle = document.getElementById('menuToggle');
            if (menuToggle) {
                menuToggle.addEventListener('click', toggleMobileMenu);
            }
        });

        // Close modals when clicking outside
        window.onclick = function(event) {
            const modals = ['videoModal', 'premiumModal', 'certificateModal'];
            modals.forEach(modalId => {
                const modal = document.getElementById(modalId);
                if (modal && event.target === modal) {
                    if (modalId === 'videoModal') {
                        closeVideoModal();
                    } else {
                        modal.style.display = 'none';
                    }
                }
            });
        }

        // Handle escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                const modals = ['videoModal', 'premiumModal', 'certificateModal'];
                modals.forEach(modalId => {
                    const modal = document.getElementById(modalId);
                    if (modal && modal.style.display === 'block') {
                        if (modalId === 'videoModal') {
                            closeVideoModal();
                        } else {
                            modal.style.display = 'none';
                        }
                    }
                });
                
                const mobileMenu = document.getElementById('mobileMenu');
                if (mobileMenu && mobileMenu.classList.contains('show')) {
                    toggleMobileMenu();
                }
            }
        });

        // Handle window resize
        window.addEventListener('resize', function() {
            if (window.innerWidth > 768) {
                const mobileMenu = document.getElementById('mobileMenu');
                const toggle = document.getElementById('menuToggle');
                
                if (mobileMenu && toggle) {
                    mobileMenu.classList.remove('show');
                    toggle.textContent = '‚ò∞';
                }
            }
        });
    </script>
</body>
</html>
